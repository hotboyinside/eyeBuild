FROM node:22-alpine

RUN apk update
RUN apk upgrade
RUN apk add --no-cache git

WORKDIR /app
COPY . .

ARG NEXT_PUBLIC_SERVER_URL
ARG NEXT_PUBLIC_ADMIN_EMAIL
ENV NEXT_PUBLIC_SERVER_URL=$NEXT_PUBLIC_SERVER_URL
ENV NEXT_PUBLIC_ADMIN_EMAIL=$NEXT_PUBLIC_ADMIN_EMAIL

RUN npm install
RUN npm run build
EXPOSE 3000

ENTRYPOINT ["npm", "start"]